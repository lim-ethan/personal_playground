# 아파치 드루이드(Apache Druid) 설명

아파치 드루이드(Apache Druid)는 빅데이터 분석용 **실시간 분석 데이터베이스**라 할 수 있음.
보통 "OLAP 엔진"이라고 불리기도 하는데, 전통적인 RDBMS랑은 성격이 좀 다르며, 특히 **대량의 이벤트 데이터**나 **스트리밍 데이터**를 실시간으로 받아서 바로 쿼리할 수 있는 강점이 있음.  

---

## 드루이드의 핵심 특징

1. **실시간 데이터 수집**  
   드루이드는 Kafka나 Kinesis 같은 스트리밍 플랫폼에서 들어오는 데이터를 거의 실시간으로 인제스트(ingest) 할 수 있음. 그래서 데이터가 쌓이자마자 바로 조회가 가능하며, 특히 로그 데이터나 IoT 데이터, 클릭스트림 같은 걸 실시간으로 보고 싶을 때 사용하기 적합한 솔루션.

2. **OLAP에 특화**  
   OLAP(다차원 분석)은 "특정 기간 동안 지역별 사용자 수" 같은 집계 쿼리를 빠르게 할 수 있음. 드루이드는 내부적으로 데이터를 컬럼 기반으로 저장하고, 세그먼트 단위로 관리해서 이런 집계 연산이 엄청 빠르다는 장점이 있음.

3. **고속 쿼리 성능**  
   드루이드의 설계는 낮은 지연(latency)과 높은 처리량(throughput)에 맞춰져 있음. 내부적으로 인덱싱 구조랑 bitmap을 많이 활용해서 수십억 건 데이터도 밀리초~수초 내로 조회할 수 있다는 장점이 있음.

4. **확장성**  
   드루이드는 분산형 아키텍처를 가지고 있으며, 노드를 늘리면 데이터 처리와 쿼리 처리 성능이 함께 확장됨. (페타 바이트 단위의 데이터 처리에도 용이)

---

## 드루이드의 아키텍처 개념

드루이드 구성 노드
[데이터 소스] → [MiddleManager] → [Historical] → [Broker] → [사용자 쿼리 응답]

- **Coordinator 노드**: 세그먼트(데이터 청크)의 배치를 관리하고, 어떤 노드가 어떤 데이터를 들고 있을지 조율.
- **Overlord 노드**: 데이터 인제스트 작업을 관리. 작업(Task)을 분배하고 실행시키는 역할.
- **Broker 노드**: 사용자가 보낸 쿼리를 받아서 여러 데이터 노드에 흩어진 결과를 모아주는 역할.
- **Historical 노드**: 오래된 세그먼트를 보관하고, 쿼리 시 데이터를 제공.
- **MiddleManager 노드**: 실시간으로 들어오는 데이터를 받아 인덱싱하고 세그먼트를 만들어 Historical로 넘겨주는 역할.

즉, 데이터가 들어오면 MiddleManager가 받아서 가공하고, Historical이 저장하고, Broker가 쿼리를 받아 Historical과 Real-time 노드한테 요청을 보내서 최종 결과를 내주는 구조.

---

## 드루이드의 활용 사례

- **로그 분석**: 웹 서비스에서 사용자 로그를 실시간으로 수집하고, "어떤 페이지가 제일 많이 클릭됐는지", "트래픽이 어느 지역에서 몰렸는지" 등을 즉시 확인할 수 있음
- **IoT 데이터 모니터링**: 센서 데이터가 계속 들어올 때, 특정 값이 임계치를 넘었는지 빠르게 탐지.
- **마케팅 분석**: 광고 클릭스트림 데이터를 분석해서 캠페인 성과 확인 가능.
- **운영 모니터링**: 서버나 네트워크 지표를 드루이드에 쌓아두고 대시보드에서 실시간 모니터링.

---

## 드루이드의 장점과 한계

- **장점**
  - 실시간 데이터 수집과 조회가 빠름.
  - 대용량 데이터 분석에 적합.
  - 확장성이 뛰어나서 규모에 맞춰 쉽게 늘릴 수 있음.
  - 다양한 시각화 도구(Superset, Tableau 등)랑 쉽게 연결.

- **한계**
  - 전통적인 트랜잭션 처리(OLTP)는 100% 구현이 어려움. (e.g, 은행 계좌 이체)
  - 운영 아키텍처가 다소 복잡함. 여러 종류의 노드를 관리해야 하며, 초기 세팅이 어려움.
  - 데이터 갱신(Update/삭제)이 제한적. 주로 append-only 형태의 데이터에 적합. (Update나 중복 관련 처리가 어려움)

---
